---
title: "PA1_template"
author: "Shen"
date: "14 October 2015"
output: html_document
---

The document is written in a step-wised approach.

#Preparing Data
Loading data form zip file directly and packages used:
```{r Loading Data, results='hide'}
library(ggplot2)
data<-read.csv(unz("activity.zip","activity.csv"))
```

#Assignment 1: What is mean total number of steps taken per day?

###1. Calculate the total number of steps taken per day.
```{r}
sumStepsPerDay<-aggregate(steps ~ date,data,sum,na.action=na.pass,na.rm=TRUE)
head(sumStepsPerDay,5)
```

###2.Make a histogram of the total number of steps taken each day.
```{r}
ggplot(data=sumStepsPerDay, 
       aes(sumStepsPerDay$steps)) + 
        geom_histogram(binwidth=1000)+
        labs(title="Histogram of the total number of steps taken each day")+
        labs(x="Steps",y="Count")
```

###3.Calculate and report the mean and median of the total number of steps taken per day.
```{r,results='hide'}
Stepsmean<-as.integer(mean(sumStepsPerDay$steps,na.rm=TRUE))
Stepsmedian<-as.integer(median(sumStepsPerDay$steps,na.rm=TRUE))
```

The mean of the total number of steps taken per day is `r Stepsmean`

The median of the total number of steps taken per day is `r Stepsmedian`

#Assignment 2: What is the average daily activity pattern?
###1. Make a time series plot (i.e. type = "l") of the 5-minute interval (x-axis) and the average number of steps taken, averaged across all days (y-axis)

```{r}
average<-aggregate(steps~interval,data,mean,na.rm=TRUE,na.action=na.pass)
ggplot(data = average, 
       aes(x = average$interval, y = average$steps)) + 
        geom_line() + 
        xlab("5-minute interval") +
        ylab("average number of steps taken")
```

###2.Which 5-minute interval, on average across all the days in the dataset, contains the maximum number of steps?
```{r, results='hide'}
max<-average[which.max(average$steps),]
```

The interval contains the maximum number of steps is `r max$interval` 
with steps `r as.integer(max$steps)`

#Assignment 3: Imputing missing values
